#if defined inc_pl_invul
	#endinput
#endif
#define inc_pl_invul

static invultimer;

public OnScriptInit()
{
    itemInfoAdd(Player, "IsInvulnerable", 0);
    invultimer = SetTimer("InvulTimer", 200, 1);

#if defined pl_invul_OnScriptInit
    pl_invul_OnScriptInit();
#endif
	return 1;
}
#if defined _ALS_OnScriptInit
	#undef OnScriptInit
#else
    #define _ALS_OnScriptInit
#endif
#if defined OnScriptInit
	#undef OnScriptInit
#endif
#define OnScriptInit pl_invul_OnScriptInit
#if defined pl_invul_OnScriptInit
forward pl_invul_OnScriptInit();
#endif

public OnScriptExit()
{
#if defined pl_invul_OnScriptExit
    pl_invul_OnScriptExit();
#endif
    KillTimer(invultimer);
	return 1;
}
#if defined _ALS_OnScriptExit
	#undef OnScriptExit
#else
    #define _ALS_OnScriptExit
#endif
#if defined OnScriptExit
	#undef OnScriptExit
#endif
#define OnScriptExit pl_invul_OnScriptExit
#if defined pl_invul_OnScriptExit
forward pl_invul_OnScriptExit();
#endif

stock IsPlayerInvulnerable(playerid)
{
    if(!IsPlayerConnected(playerid))    return 0;
    return itemGetInt(itemGetByID(Player, playerid), "IsInvulnerable");
}

stock PlayerInvulnerableEnable(playerid)
{
	if(!IsPlayerConnected(playerid))    return 0;
	itemSetInt(itemGetByID(Player, playerid), "IsInvulnerable", 1);
	return 1;
}

stock PlayerInvulnerableDisable(playerid)
{
	if(!IsPlayerConnected(playerid))    return 0;
	new Item:player = itemGetByID(Player, playerid);
	if(itemGetInt(player, "IsInvulnerable"))
	{
	    SetPlayerHealth(playerid, 100.0);
	    SetPlayerArmour(playerid, 100.0);
	}
    itemSetInt(player, "IsInvulnerable", 0);
	return 1;
}

forward InvulTimer();
public InvulTimer()
{
	new List:list = GetListPlayers();
	listForeach(playerid:list)
	{
	    if(itemGetInt(itemGetByID(Player, playerid), "IsInvulnerable"))
	    {
	        SetPlayerHealth(playerid, 255.0);
	        SetPlayerArmour(playerid, 255.0);
	    }
	}
	return 1;
}

